<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Initial Data Analysis | Exploratory Data Analysis in the 21st Century</title>
  <meta name="description" content="This is a book about EDA today." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Initial Data Analysis | Exploratory Data Analysis in the 21st Century" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a book about EDA today." />
  <meta name="github-repo" content="https://github.com/dicook/explore-data" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Initial Data Analysis | Exploratory Data Analysis in the 21st Century" />
  
  <meta name="twitter:description" content="This is a book about EDA today." />
  

<meta name="author" content="Di Cook and Emi Tanaka" />


<meta name="date" content="2021-06-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="what-is-eda.html"/>
<link rel="next" href="working-with-a-single-variable.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">This is a book about EDA today. </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="what-is-eda.html"><a href="what-is-eda.html"><i class="fa fa-check"></i><b>2</b> What is exploratory data analysis?</a>
<ul>
<li class="chapter" data-level="2.1" data-path="what-is-eda.html"><a href="what-is-eda.html#current-interpretations"><i class="fa fa-check"></i><b>2.1</b> Current interpretations</a></li>
<li class="chapter" data-level="2.2" data-path="what-is-eda.html"><a href="what-is-eda.html#differentiating-from-traditional-analysis"><i class="fa fa-check"></i><b>2.2</b> Differentiating from traditional analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="what-is-eda.html"><a href="what-is-eda.html#from-the-case-study"><i class="fa fa-check"></i><b>2.2.1</b> From the case study</a></li>
<li class="chapter" data-level="2.2.2" data-path="what-is-eda.html"><a href="what-is-eda.html#eda-approach"><i class="fa fa-check"></i><b>2.2.2</b> EDA approach</a></li>
<li class="chapter" data-level="2.2.3" data-path="what-is-eda.html"><a href="what-is-eda.html#summarising-the-difference"><i class="fa fa-check"></i><b>2.2.3</b> Summarising the difference</a></li>
<li class="chapter" data-level="2.2.4" data-path="what-is-eda.html"><a href="what-is-eda.html#reality-check"><i class="fa fa-check"></i><b>2.2.4</b> Reality check</a></li>
<li class="chapter" data-level="2.2.5" data-path="what-is-eda.html"><a href="what-is-eda.html#what-is-eda-1"><i class="fa fa-check"></i><b>2.2.5</b> What is EDA?</a></li>
<li class="chapter" data-level="2.2.6" data-path="what-is-eda.html"><a href="what-is-eda.html#isnt-it-data-snooping"><i class="fa fa-check"></i><b>2.2.6</b> Isn’t it data snooping?</a></li>
<li class="chapter" data-level="2.2.7" data-path="what-is-eda.html"><a href="what-is-eda.html#why-arent-there-more-resources-on-eda"><i class="fa fa-check"></i><b>2.2.7</b> Why aren’t there more resources on EDA?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="what-is-eda.html"><a href="what-is-eda.html#the-origins-of-eda"><i class="fa fa-check"></i><b>2.3</b> The origins of EDA</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="what-is-eda.html"><a href="what-is-eda.html#guiding-principles"><i class="fa fa-check"></i><b>2.3.1</b> Guiding principles</a></li>
<li class="chapter" data-level="2.3.2" data-path="what-is-eda.html"><a href="what-is-eda.html#scratching-down-numbers"><i class="fa fa-check"></i><b>2.3.2</b> Scratching down numbers</a></li>
<li class="chapter" data-level="2.3.3" data-path="what-is-eda.html"><a href="what-is-eda.html#schematic-summary"><i class="fa fa-check"></i><b>2.3.3</b> Schematic summary</a></li>
<li class="chapter" data-level="2.3.4" data-path="what-is-eda.html"><a href="what-is-eda.html#easy-re-expression"><i class="fa fa-check"></i><b>2.3.4</b> Easy re-expression</a></li>
<li class="chapter" data-level="2.3.5" data-path="what-is-eda.html"><a href="what-is-eda.html#effective-comparison"><i class="fa fa-check"></i><b>2.3.5</b> Effective comparison</a></li>
<li class="chapter" data-level="2.3.6" data-path="what-is-eda.html"><a href="what-is-eda.html#plots-of-relationship"><i class="fa fa-check"></i><b>2.3.6</b> Plots of relationship</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="what-is-eda.html"><a href="what-is-eda.html#exercises"><i class="fa fa-check"></i><b>2.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html"><i class="fa fa-check"></i><b>3</b> Initial Data Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#data-description"><i class="fa fa-check"></i><b>3.1</b> Data description</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#checking-the-data-type"><i class="fa fa-check"></i><b>3.1.1</b> Checking the data type</a></li>
<li class="chapter" data-level="3.1.2" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#checking-the-data-quality"><i class="fa fa-check"></i><b>3.1.2</b> Checking the data quality</a></li>
<li class="chapter" data-level="3.1.3" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#check-on-data-collection-method"><i class="fa fa-check"></i><b>3.1.3</b> Check on data collection method</a></li>
<li class="chapter" data-level="3.1.4" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#check-for-experimental-data"><i class="fa fa-check"></i><b>3.1.4</b> Check for experimental data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#model-formulation"><i class="fa fa-check"></i><b>3.2</b> Model formulation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#review-linear-models-in-r"><i class="fa fa-check"></i><b>3.2.1</b> Review: Linear models in R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#model-formulation-1"><i class="fa fa-check"></i><b>3.3</b> Model formulation</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#experimental-design"><i class="fa fa-check"></i><b>3.3.1</b> Experimental Design</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="initial-data-analysis.html"><a href="initial-data-analysis.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="working-with-a-single-variable.html"><a href="working-with-a-single-variable.html"><i class="fa fa-check"></i><b>4</b> Working with a single variable</a></li>
<li class="chapter" data-level="5" data-path="bivariate-dependencies-and-relationships.html"><a href="bivariate-dependencies-and-relationships.html"><i class="fa fa-check"></i><b>5</b> Bivariate dependencies and relationships</a></li>
<li class="chapter" data-level="6" data-path="going-beyond-two-variables.html"><a href="going-beyond-two-variables.html"><i class="fa fa-check"></i><b>6</b> Going beyond two variables</a></li>
<li class="chapter" data-level="7" data-path="making-comparisons-between-groups-and-strata.html"><a href="making-comparisons-between-groups-and-strata.html"><i class="fa fa-check"></i><b>7</b> Making comparisons between groups and strata</a></li>
<li class="chapter" data-level="8" data-path="sculpting-data-using-models.html"><a href="sculpting-data-using-models.html"><i class="fa fa-check"></i><b>8</b> Sculpting data using models</a></li>
<li class="chapter" data-level="9" data-path="exploring-data-having-a-space-and-time-context.html"><a href="exploring-data-having-a-space-and-time-context.html"><i class="fa fa-check"></i><b>9</b> Exploring data having a space and time context</a></li>
<li class="chapter" data-level="10" data-path="is-what-you-see-really-there.html"><a href="is-what-you-see-really-there.html"><i class="fa fa-check"></i><b>10</b> Is what you see really there?</a></li>
<li class="chapter" data-level="11" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>11</b> Final words</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href= https://github.com/dicook/exploratory-data-analysis-in-the-21st-century" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploratory Data Analysis in the 21st Century</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="initial-data-analysis" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Initial Data Analysis</h1>
<p>In Chapter <a href="what-is-eda.html#what-is-eda">2</a>, we mentioned that data analysis includes <strong>initial data analysis</strong> (IDA). There are various definitions of IDA, much like there are numerous definitions for EDA. Some people would be practising IDA without explicitly realising that it is
IDA. Or in other cases, a different name is used to describe the same
process, such as <span class="citation"><a href="#ref-Chatfield1985" role="doc-biblioref">Chatfield</a> (<a href="#ref-Chatfield1985" role="doc-biblioref">1985</a>)</span> referring to IDA also as “initial
examination of data” and Cox &amp; Snell (1981) as “preliminary data
anlysis” and Rao (1983) as “cross-examination of data.” So what is IDA?</p>
<div class="aim">
<p>
The two main objectives for <strong>initial data analysis</strong> are:
</p>
<ol style="list-style-type: decimal">
<li>
data description, and
</li>
<li>
model formulation.
</li>
</ol>
</div>
<p>IDA differs from the main analysis (i.e. usually fitting the
model, conducting significance tests, making inferences or
predictions).
IDA is often unreported in the data analysis reports or
scientific papers due to it being “uninteresting” or “obvious.”
The role of the main analysis is to answer the intended
question(s) that the data were collected for.
Sometimes IDA alone is sufficient.</p>
<div id="data-description" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Data description</h2>
<p>Data description should be one of the first steps in the data
analysis to assess the structure and quality of the data. We refer them to occasionally as data sniffing or data scrutinizing. These include using common or domain knowledge to check if the recorded data have sensible values. E.g. Are positive values, e.g. height and weight, recorded as
positive values with a plausible range? If the data are counts, are the recorded values contain noninteger values? For compositional data, do the values add up to 100% (or 1)? If not is that a measurement error or due to rounding? Or is another variable missing?</p>
<p>In addition, numerical or graphical summaries may reveal that
there is unwanted structure in the data. E.g., Does the treatment group have different demographic characteristics to the control group? Does the distribution of the data imply violations of assumptions for the main analysis?</p>
<p>Data sniffing or data scrutinizing is a process that you get better
at with practice and have familiarity with the domain area.</p>
<p>Aside from checking the data structure or data quality, it’s
important to check how the data are understood by the
computer, i.e. checking for data type is also important. E.g.,</p>
<ul>
<li>Was the date read in as character?</li>
<li>Was a factor read in as numeric?</li>
</ul>
<div id="checking-the-data-type" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Checking the data type</h3>
<div class="eg">
<p><strong>Example 1</strong>: Consider the following data stored as an excel sheet.</p>
<p><img src="images/example-data-type.png" width="300px" /></p>
<p>We read this data into R as below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="initial-data-analysis.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="initial-data-analysis.html#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/example-data-type.xlsx&quot;</span>)</span></code></pre></div>
<p>Below is a print out of the data object. Are there any issues here?</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="initial-data-analysis.html#cb2-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##      id date                loc       temp
##   &lt;dbl&gt; &lt;dttm&gt;              &lt;chr&gt;    &lt;dbl&gt;
## 1     1 2010-01-03 00:00:00 New York  42  
## 2     2 2010-02-03 00:00:00 New York  41.4
## 3     3 2010-03-03 00:00:00 New York  38.5
## 4     4 2010-04-03 00:00:00 New York  41.1
## 5     5 2010-05-03 00:00:00 New York  39.8</code></pre>
</div>
<p>In the United States, it is common to use the date format MM/DD/YYYY while the rest of the world commonly use DD/MM/YYYY or YYYY/MM/DD. It is highly probable that the dates are 1st-5th March and not 3rd of Jan-May. You can <strong>validate data with external sources</strong>, e.g. say the temperature at New York during the two choices suggest that the dates are 1st-5th March.</p>
<p>The benefit of working with data grounded in the real world process is that there are generally means to sanity check. You can robustify your workflow by ensuring that you have an explicit check for the expected data type (and values) in your code.</p>
<p>In the code below, we write our expected types and further coerce some data types to what we want.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="initial-data-analysis.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="initial-data-analysis.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_excel</span>(<span class="st">&quot;data/example-data-type.xlsx&quot;</span>, </span>
<span id="cb4-3"><a href="initial-data-analysis.html#cb4-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">col_types =</span> <span class="fu">c</span>(<span class="st">&quot;text&quot;</span>, <span class="st">&quot;date&quot;</span>, <span class="st">&quot;text&quot;</span>, <span class="st">&quot;numeric&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="initial-data-analysis.html#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="fu">as.factor</span>(id),</span>
<span id="cb4-5"><a href="initial-data-analysis.html#cb4-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> <span class="fu">as.character</span>(date),</span>
<span id="cb4-6"><a href="initial-data-analysis.html#cb4-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> <span class="fu">as.Date</span>(date, <span class="at">format =</span> <span class="st">&quot;%Y-%d-%m&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   id    date       loc       temp
##   &lt;fct&gt; &lt;date&gt;     &lt;chr&gt;    &lt;dbl&gt;
## 1 1     2010-03-01 New York  42  
## 2 2     2010-03-02 New York  41.4
## 3 3     2010-03-03 New York  38.5
## 4 4     2010-03-04 New York  41.1
## 5 5     2010-03-05 New York  39.8</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="initial-data-analysis.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">&quot;data/example-data-type.csv&quot;</span>,</span>
<span id="cb6-2"><a href="initial-data-analysis.html#cb6-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">id =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb6-3"><a href="initial-data-analysis.html#cb6-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">date =</span> <span class="fu">col_date</span>(<span class="at">format =</span> <span class="st">&quot;%m/%d/%y&quot;</span>),</span>
<span id="cb6-4"><a href="initial-data-analysis.html#cb6-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">loc =</span> <span class="fu">col_character</span>(),</span>
<span id="cb6-5"><a href="initial-data-analysis.html#cb6-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">temp =</span> <span class="fu">col_double</span>()))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   id    date       loc       temp
##   &lt;fct&gt; &lt;date&gt;     &lt;chr&gt;    &lt;dbl&gt;
## 1 1     2010-03-01 New York  42  
## 2 2     2010-03-02 New York  41.4
## 3 3     2010-03-03 New York  38.5
## 4 4     2010-03-04 New York  41.1
## 5 5     2010-03-05 New York  39.8</code></pre>
<p>The checks (or coercions) ensure that even if the data are updated, you can have some confidence that any data type error will be picked up before further analysis.</p>
</div>
<div id="checking-the-data-quality" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Checking the data quality</h3>
<p>Numerical or graphical summaries, or even just eye-balling the data, helps to uncover some data quality issues. Do you see any issues for the data below?</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="initial-data-analysis.html#cb8-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/example-data-quality.csv&quot;</span>,</span>
<span id="cb8-2"><a href="initial-data-analysis.html#cb8-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">id =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb8-3"><a href="initial-data-analysis.html#cb8-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">date =</span> <span class="fu">col_date</span>(<span class="at">format =</span> <span class="st">&quot;%m/%d/%y&quot;</span>),</span>
<span id="cb8-4"><a href="initial-data-analysis.html#cb8-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">loc =</span> <span class="fu">col_character</span>(),</span>
<span id="cb8-5"><a href="initial-data-analysis.html#cb8-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">temp =</span> <span class="fu">col_double</span>()))</span>
<span id="cb8-6"><a href="initial-data-analysis.html#cb8-6" aria-hidden="true" tabindex="-1"></a>df2</span></code></pre></div>
<pre><code>## # A tibble: 9 x 4
##   id    date       loc        temp
##   &lt;fct&gt; &lt;date&gt;     &lt;chr&gt;     &lt;dbl&gt;
## 1 1     2010-03-01 New York   42  
## 2 2     2010-03-02 New York   41.4
## 3 3     2010-03-03 New York   38.5
## 4 4     2010-03-04 New York   41.1
## 5 5     2010-03-05 New York   39.8
## 6 6     2020-03-01 Melbourne  30.6
## 7 7     2020-03-02 Melbourne  17.9
## 8 8     2020-03-03 Melbourne  18.6
## 9 9     2020-03-04 &lt;NA&gt;       21.3</code></pre>
<p>There is a missing value in <code>loc</code>. Temperature is in Farenheit for New York but Celsius in Melbourne. You can find this out again using external sources.</p>
<div class="case">
<p>Consider the soybean study conducted in Brazil (cite Lehner 2016). This study collected multiple traits of soybeans grown at multiple locations over years.</p>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="initial-data-analysis.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb10-2"><a href="initial-data-analysis.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;lehner.soybeanmold&quot;</span>, <span class="at">package =</span> <span class="st">&quot;agridat&quot;</span>)</span>
<span id="cb10-3"><a href="initial-data-analysis.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vis_miss</span>(lehner.soybeanmold)</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Inspecting the data reveals that there are a number of missing values for sclerotia and these values do not necessary appear missing at random. We could check if observational units that are missing values for sclerotia, have different yield say.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="initial-data-analysis.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lehner.soybeanmold, <span class="fu">aes</span>(sclerotia, yield)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="initial-data-analysis.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_miss_point</span>()</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We could also compare the new data with old data.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="initial-data-analysis.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inspectdf)</span>
<span id="cb12-2"><a href="initial-data-analysis.html#cb12-2" aria-hidden="true" tabindex="-1"></a>soy_old <span class="ot">&lt;-</span> lehner.soybeanmold <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="initial-data-analysis.html#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="dv">2010</span><span class="sc">:</span><span class="dv">2011</span>)</span>
<span id="cb12-4"><a href="initial-data-analysis.html#cb12-4" aria-hidden="true" tabindex="-1"></a>soy_new <span class="ot">&lt;-</span> lehner.soybeanmold <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="initial-data-analysis.html#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2012</span>)</span>
<span id="cb12-6"><a href="initial-data-analysis.html#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="initial-data-analysis.html#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">inspect_cor</span>(soy_old, soy_new) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="initial-data-analysis.html#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show_plot</span>()</span></code></pre></div>
<pre><code>## Warning: Columns with 0 variance found: year</code></pre>
<p><img src="eda-book_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="check-on-data-collection-method" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Check on data collection method</h3>
<p>Next we study the data from ABS that shows the total number of people employed in a given month from February 1976 to December 2019 using the original time series.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="initial-data-analysis.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readabs)</span>
<span id="cb14-2"><a href="initial-data-analysis.html#cb14-2" aria-hidden="true" tabindex="-1"></a>employed <span class="ot">&lt;-</span> <span class="fu">read_abs</span>(<span class="at">series_id =</span> <span class="st">&quot;A84423085A&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="initial-data-analysis.html#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date),</span>
<span id="cb14-4"><a href="initial-data-analysis.html#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> <span class="fu">factor</span>(lubridate<span class="sc">::</span><span class="fu">year</span>(date))) <span class="sc">%&gt;%</span> </span>
<span id="cb14-5"><a href="initial-data-analysis.html#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="st">&quot;2020&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-6"><a href="initial-data-analysis.html#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, month, year, value) </span></code></pre></div>
<p>Do you notice anything?</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="initial-data-analysis.html#cb15-1" aria-hidden="true" tabindex="-1"></a>employed  <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="initial-data-analysis.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, value, <span class="at">color =</span> year)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="initial-data-analysis.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb15-4"><a href="initial-data-analysis.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;1978 Feb - 2019 Dec&quot;</span>) </span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-11-1.png" width="1152" /></p>
<p>Why do you think the number of people employed is going up each year?</p>
<p><img src="eda-book_files/figure-html/unnamed-chunk-12-1.png" width="576" /></p>
<p>There’s a suspicious change in August numbers from 2014.</p>
<p><img src="eda-book_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>A potential explanation for this is that there was a <em>change in the survey from 2014</em>. Also see <a href="https://robjhyndman.com/hyndsight/abs-seasonal-adjustment-2/" class="uri">https://robjhyndman.com/hyndsight/abs-seasonal-adjustment-2/</a></p>
<p><strong>Check if the <em>data collection</em> method has been consistent.</strong></p>
</div>
<div id="check-for-experimental-data" class="section level3" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Check for experimental data</h3>
<p>For experimental data, there would generally be some descriptions that include the experimental layout and any randomisation process of controlled variables (e.g. treatments) to units.</p>
<p>Consider the experiment below. The experiment tests the effects of 9 fertilizer treatments on the yield of brussel sprouts on a field laid out in a rectangular array of 6 rows and 8 columns.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="initial-data-analysis.html#cb16-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/example-experimental-data.csv&quot;</span>, </span>
<span id="cb16-2"><a href="initial-data-analysis.html#cb16-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">row =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb16-3"><a href="initial-data-analysis.html#cb16-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">col =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb16-4"><a href="initial-data-analysis.html#cb16-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">yield =</span> <span class="fu">col_double</span>(),</span>
<span id="cb16-5"><a href="initial-data-analysis.html#cb16-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">trt =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb16-6"><a href="initial-data-analysis.html#cb16-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">block =</span> <span class="fu">col_factor</span>()))</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-15-1.png" width="672" /><img src="eda-book_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="initial-data-analysis.html#cb17-1" aria-hidden="true" tabindex="-1"></a>df3 <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="initial-data-analysis.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">fct_reorder</span>(trt, yield)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="initial-data-analysis.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(trt, yield)) <span class="sc">+</span> </span>
<span id="cb17-4"><a href="initial-data-analysis.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb17-5"><a href="initial-data-analysis.html#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">x =</span> <span class="fu">guide_axis</span>(<span class="at">n.dodge =</span> <span class="dv">2</span>))</span></code></pre></div>
<p><img src="eda-book_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>High sulphur and high manure seems to best for the yield of brussel sprouts. Any issues here?</p>
</div>
</div>
<div id="model-formulation" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Model formulation</h2>
<div class="info">
<p>
Note: there are variety of ways to do IDA and you don’t need to prescribe to what we show you.
</p>
</div>
<div id="review-linear-models-in-r" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Review: Linear models in R</h3>
<p>Consider the bivariate data <code>cars</code> were it contains the variables <code>dist</code> (distance travelled) and <code>speed</code> (speed of the car) with the data shown in Figure <a href="initial-data-analysis.html#fig:plot-cars">3.1</a>.</p>

<div class="figure"><span id="fig:plot-cars"></span>
<img src="eda-book_files/figure-html/plot-cars-1.png" alt="The plot of the speed of cars vs. the distance travelled." width="672" />
<p class="caption">
Figure 3.1: The plot of the speed of cars vs. the distance travelled.
</p>
</div>
<p>thes models can be fitted in R as follows:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="initial-data-analysis.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(speed <span class="sc">~</span> dist, <span class="at">data =</span> cars)</span></code></pre></div>
<p>which is the same as</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="initial-data-analysis.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(speed <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> dist, <span class="at">data =</span> cars)</span></code></pre></div>
<p>and for <span class="math inline">\(i = 1, ... 50\)</span> mathematically can be written as</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1 x_i + e_i,\]</span>
where:</p>
<ul>
<li><span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> are the speed (in mph) and stopping distance (in ft), respectively of the <span class="math inline">\(i\)</span>-th car,</li>
<li><span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are intercept and slope, respectively, and</li>
<li><span class="math inline">\(e_i\)</span> is the random error, typically assuming that <span class="math inline">\(e_i \sim N(0, \sigma^2)\)</span>.</li>
</ul>
</div>
</div>
<div id="model-formulation-1" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Model formulation</h2>
<ul>
<li>Say, we are interested in characterising the price of the diamond in terms of its carat.</li>
</ul>
<p><img src="eda-book_files/figure-html/plot-diamond-1.png" width="672" /></p>
<p>Looking at this plot, would you fit a linear model with formula <code>price ~ 1 + carat</code>? What about <code>price ~ poly(carat, 2)</code> which is the same as fitting:</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1x_i + \beta_2x_i^2 + e_i.\]</span>
Do we need to modify the assumption of the error distribution? Should we make some transformation before modelling? Are there other candidate models? By the way do you notice a wall like structure for prices at 1, 1.5 and 2 carat?</p>
<p>Notice that we did no formal statistical inference as we initially try to formulate the model. The goal of the main analysis is to characterise the price of a diamond by its carat. This may involve:</p>
<ul>
<li>formal inference for model selection,</li>
<li>justification of the selected “final” model, and</li>
<li>fitting the final model.</li>
</ul>
<p>There may be in fact far more models considered but discarded at the IDA stage. These discarded models are hardly ever reported. Consequently, majority of reported statistics give a distorted view and it’s important to remind yourself what might <em>not</em> be reported.</p>
<blockquote>
<p>“All models are approximate and tentative; approximate in the sense that no model is exactly true and tentative in that they may be modified in the light of further data”</p>
– Chatfield (1985)
</blockquote>
<blockquote>
<p>“All models are wrong but some are useful”</p>
– George Box
</blockquote>
<div class="case">
<p>A wheat breeding trial to test 107 varieties (also called genotype) is conducted in a field experiment laid out in a rectangular array with 22 rows and 15 columns.</p>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="initial-data-analysis.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;gilmour.serpentine&quot;</span>, <span class="at">package =</span> <span class="st">&quot;agridat&quot;</span>)</span></code></pre></div>
<div id="experimental-design" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Experimental Design</h3>
<p>The experiment employs what is referred to as a randomised complete block design (RCBD) (technically it is near-complete and not exactly RCBD due to check varieties have double the replicates of test varieties).</p>
<p>RCBD means that:</p>
<ul>
<li>the there are equal number of replicates for each treatment (here it is gen);</li>
<li>each treatment appears exactly once in each block;</li>
<li>the blocks are of the same size; and</li>
<li>each treatment are randomised within block.</li>
</ul>
<p>In agricultural field experiments, blocks are formed spatially by grouping plots within contiguous areas (called <code>rep</code> here).</p>
<p>The boundaries of blocks may be chosen arbitrary.</p>
<ul>
<li>In the main analysis, people would commonly analyse this using what is called <strong>two-way ANOVA</strong> model (with no interaction effect).</li>
<li>The two-way ANOVA model has the form
<center>
<code>yield = mean + block + treatment + error</code>
</center></li>
<li>So for this data,</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="initial-data-analysis.html#cb21-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> rep <span class="sc">+</span> gen, </span>
<span id="cb21-2"><a href="initial-data-analysis.html#cb21-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gilmour.serpentine)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="initial-data-analysis.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ 1 + rep + gen, data = gilmour.serpentine)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -245.070  -69.695   -1.182   71.427  250.652 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      720.248     67.335  10.697  &lt; 2e-16 ***
## repR2             96.100     15.585   6.166 3.29e-09 ***
## repR3           -129.845     15.585  -8.331 8.44e-15 ***
## gen(WqKPWmH*3Ag   24.333     94.372   0.258 0.796766    
## genAMERY         -93.333     94.372  -0.989 0.323747    
## genANGAS        -132.667     94.372  -1.406 0.161192    
## genAROONA       -153.667     94.372  -1.628 0.104884    
## genBATAVIA      -175.333     94.372  -1.858 0.064513 .  
## genBD231         -70.333     94.372  -0.745 0.456895    
## genBEULAH       -173.667     94.372  -1.840 0.067074 .  
## genBLADE        -270.000     94.372  -2.861 0.004628 ** 
## genBT_SCHOMBURG  -49.000     94.372  -0.519 0.604125    
## genCADOUX       -223.333     94.372  -2.367 0.018820 *  
## genCONDOR       -124.333     94.372  -1.317 0.189041    
## genCORRIGIN     -217.667     94.372  -2.306 0.022010 *  
## genCUNNINGHAM   -254.667     94.372  -2.699 0.007502 ** 
## genDGR/MNX-9-9e  -47.667     94.372  -0.505 0.613996    
## genDOLLARBIRD   -200.667     94.372  -2.126 0.034584 *  
## genEXCALIBUR     -55.000     94.372  -0.583 0.560621    
## genGOROKE       -141.667     94.372  -1.501 0.134743    
## genHALBERD       -53.333     94.372  -0.565 0.572551    
## genHOUTMAN      -209.333     94.372  -2.218 0.027560 *  
## genJANZ         -214.667     94.372  -2.275 0.023884 *  
## genK2011-5*      -87.333     94.372  -0.925 0.355758    
## genKATUNGA      -110.333     94.372  -1.169 0.243609    
## genKIATA        -165.667     94.372  -1.755 0.080565 .  
## genKITE         -180.000     94.372  -1.907 0.057772 .  
## genKULIN         -91.000     94.372  -0.964 0.335964    
## genLARK         -336.333     94.372  -3.564 0.000448 ***
## genLOWAN        -152.333     94.372  -1.614 0.107915    
## genM4997        -146.000     94.372  -1.547 0.123277    
## genM5075        -194.667     94.372  -2.063 0.040304 *  
## genM5097        -102.667     94.372  -1.088 0.277826    
## genMACHETE      -231.333     94.372  -2.451 0.015010 *  
## genMEERING      -247.667     94.372  -2.624 0.009286 ** 
## genMOLINEUX     -165.667     94.372  -1.755 0.080565 .  
## genOSPREY       -162.000     94.372  -1.717 0.087451 .  
## genOUYEN        -136.667     94.372  -1.448 0.148986    
## genOXLEY        -221.667     94.372  -2.349 0.019713 *  
## genPELSART      -200.333     94.372  -2.123 0.034882 *  
## genPEROUSE      -283.667     94.372  -3.006 0.002955 ** 
## genRAC655       -112.667     94.372  -1.194 0.233813    
## genRAC655&#39;S&#39;    -113.667     94.372  -1.204 0.229702    
## genRAC696         -3.667     94.372  -0.039 0.969042    
## genRAC710        -51.000     94.372  -0.540 0.589455    
## genRAC750        -77.333     94.372  -0.819 0.413410    
## genRAC759        -42.000     94.372  -0.445 0.656721    
## genRAC772          5.000     94.372   0.053 0.957794    
## genRAC777       -172.333     94.372  -1.826 0.069183 .  
## genRAC779          3.667     94.372   0.039 0.969042    
## genRAC787       -118.000     94.372  -1.250 0.212486    
## genRAC791        -72.667     94.372  -0.770 0.442120    
## genRAC792       -102.333     94.372  -1.084 0.279385    
## genRAC798         -1.667     94.372  -0.018 0.985926    
## genRAC804        -45.000     94.372  -0.477 0.633949    
## genRAC805        -43.000     94.372  -0.456 0.649093    
## genRAC806        -35.333     94.372  -0.374 0.708462    
## genRAC807        -91.333     94.372  -0.968 0.334201    
## genRAC808        -54.000     94.372  -0.572 0.567765    
## genRAC809        -43.333     94.372  -0.459 0.646559    
## genRAC810       -131.667     94.372  -1.395 0.164359    
## genRAC811         42.333     94.372   0.449 0.654174    
## genRAC812        -94.000     94.372  -0.996 0.320310    
## genRAC813        -83.333     94.372  -0.883 0.378179    
## genRAC814        -72.333     94.372  -0.766 0.444214    
## genRAC815       -111.000     94.372  -1.176 0.240781    
## genRAC816        -66.333     94.372  -0.703 0.482862    
## genRAC817       -100.000     94.372  -1.060 0.290466    
## genRAC818       -107.000     94.372  -1.134 0.258101    
## genRAC819       -121.333     94.372  -1.286 0.199895    
## genRAC820         -1.000     94.372  -0.011 0.991555    
## genRAC821        -98.333     94.372  -1.042 0.298560    
## genROSELLA      -184.333     94.372  -1.953 0.052050 .  
## genSCHOMBURGK   -132.333     94.372  -1.402 0.162242    
## genSHRIKE       -128.000     94.372  -1.356 0.176376    
## genSPEAR        -254.667     94.372  -2.699 0.007502 ** 
## genSTILETTO     -157.000     94.372  -1.664 0.097603 .  
## genSUNBRI       -218.333     94.372  -2.314 0.021612 *  
## genSUNFIELD     -206.667     94.372  -2.190 0.029576 *  
## genSUNLAND      -182.667     94.372  -1.936 0.054192 .  
## genSWIFT        -197.000     94.372  -2.087 0.037990 *  
## genTASMAN       -161.000     94.372  -1.706 0.089410 .  
## genTATIARA       -64.333     94.372  -0.682 0.496142    
## genTINCURRIN     -19.000     81.728  -0.232 0.816382    
## genTRIDENT      -132.667     94.372  -1.406 0.161192    
## genVF299         -66.333     94.372  -0.703 0.482862    
## genVF300        -111.667     94.372  -1.183 0.237976    
## genVF302        -108.333     94.372  -1.148 0.252234    
## genVF508          11.667     94.372   0.124 0.901725    
## genVF519          -1.000     94.372  -0.011 0.991555    
## genVF655        -160.167     81.728  -1.960 0.051283 .  
## genVF664        -106.667     94.372  -1.130 0.259583    
## genVG127        -109.667     94.372  -1.162 0.246460    
## genVG503         -43.000     94.372  -0.456 0.649093    
## genVG506        -108.667     94.372  -1.151 0.250782    
## genVG701         -19.333     94.372  -0.205 0.837867    
## genVG714        -108.333     94.372  -1.148 0.252234    
## genVG878          52.333     94.372   0.555 0.579767    
## genWARBLER      -217.000     94.372  -2.299 0.022415 *  
## genWI216           4.000     94.372   0.042 0.966230    
## genWI221         -17.333     94.372  -0.184 0.854440    
## genWI231        -218.333     94.372  -2.314 0.021612 *  
## genWI232         -56.333     94.372  -0.597 0.551165    
## genWILGOYNE     -131.000     94.372  -1.388 0.166496    
## genWW1402       -117.333     94.372  -1.243 0.215071    
## genWW1477       -185.667     81.728  -2.272 0.024064 *  
## genWW1831        -86.667     94.372  -0.918 0.359435    
## genWYUNA        -176.667     94.372  -1.872 0.062524 .  
## genYARRALINKA   -245.000     94.372  -2.596 0.010061 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 115.6 on 221 degrees of freedom
## Multiple R-squared:  0.6226, Adjusted R-squared:  0.4381 
## F-statistic: 3.375 on 108 and 221 DF,  p-value: 1.081e-14</code></pre>
<p><img src="eda-book_files/figure-html/top10geno-model-1.png" width="480" /></p>
<p><img src="eda-book_files/figure-html/top10geno-mean-1.png" width="480" />
<img src="eda-book_files/figure-html/top10geno-median-1.png" width="480" /></p>
<p>Do you notice anything from below?</p>
<p><img src="eda-book_files/figure-html/gilmour-plot-1.png" width="672" /></p>
<ul>
<li>It’s well known in agricultural field trials that spatial variations are introduced in traits; this could be because of the fertility trend, management practices or other reasons.</li>
<li>In the IDA stage, you investigate to identify these spatial variations - you cannot just simply fit a two-way ANOVA model!</li>
</ul>
<blockquote>
<p>Teaching of Statistics should provide a more balanced blend of IDA and inference</p>
– Chatfield (1985)
</blockquote>
<p>Yet there is still very little emphasis of it in teaching and also at times in practice. So don’t forget to do IDA!</p>
</div>
</div>
<div id="summary" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Summary</h2>
<ul>
<li><strong><em>Initial data analysis</em></strong> (IDA) is a model-focussed exploration of data with two main objectives:
<ul>
<li><strong><em>data description</em></strong> including scrutinizing for data quality, and</li>
<li><strong><em>model formulation</em></strong> without any formal statistical inference.</li>
</ul></li>
<li>IDA hardly sees the limelight even if it’s the very foundation of what the main analysis is built on.</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Chatfield1985" class="csl-entry">
Chatfield, C. 1985. <span>“The Initial Examination of Data.”</span> <em>Journal of the Royal Statistical Society. Series A</em> 148 (3): 214–53.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="what-is-eda.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="working-with-a-single-variable.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["eda-book.pdf", "eda-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
